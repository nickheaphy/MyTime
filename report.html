<!DOCTYPE html>
<html>
  <head>
    <style>
        body {
            background-color: #FF3CAC;
            background-image: linear-gradient(225deg, #FF3CAC 0%, #784BA0 50%, #2B86C5 100%);
        }

        #reportholder {
            background-color: white;
            margin: 40px;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0px 0px 25px 0px rgb(0, 0, 0);
            height: 100%;
        }

    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar/index.global.min.js'></script>
    <script src='helperfunctions.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        
</head>
    <body onload="getPrimaryData()"></body>>
        <div id='reportholder'>
            <canvas id="myChart" width="400" height="400"></canvas>
        </div>
        <script>
            donutdata = []
            donutlabels = []
            donutcolours = []
            async function getPrimaryData() {
                const data = new URLSearchParams(window.location.search);
                try {
                    const responce = await fetch("/reportPrimaryfromDB?"+data.toString())
                    donutdata = await responce.json()
                    for (i=0; i< donutdata.length; i++) {
                        donutlabels.push(donutdata[i].Primaryname)
                        donutcolours.push("#" + donutdata[i].Colour)
                    }
                    drawdonut()
                } catch (error) {
                    console.log(error)
                }
            }

            function drawdonut() {
                const ctx = document.getElementById('myChart');
            
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: donutlabels,
                        datasets: [{
                            data: donutdata,
                            backgroundColor: donutcolours
                        }]
                    },
                    options: {
                        parsing: {
                            key: 'Duration'
                    }
                }
                });
            }
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    </body>
  </html>